---
// src/pages/noticias/[id].astro
import Layout from '../../layouts/Layout.astro';
import SectionContainer from "../../components/SectionContainer.astro";
import NewsForm from "../../components/NewsForm.astro";

// Función para generar las rutas dinámicas
export async function getStaticPaths() {
  // Los datos de noticias
  const noticias = [
    {
      id: "victoria-juvenil",
      titulo: '¡Victoria épica del equipo juvenil!',
      descripcion: 'El equipo juvenil ganó 85-82 en un partido increíble...',
      contenido: 'El equipo juvenil logró una victoria histórica 85-82 contra su principal rival en un partido que mantuvo a todos al borde de sus asientos hasta el último segundo. Con esta victoria, nuestros juveniles se colocan en el primer puesto de la clasificación y cada vez más cerca del campeonato regional.',
      fecha: '15 abril 2025',
      imagen: '/images/noticia1.jpg',
      formulario: false,
      tipoFormulario: null
    },
    {
      id: "campus-verano",
      titulo: 'Campus de verano 2025: ¡Inscríbete ya!',
      descripcion: 'Ya están abiertas las inscripciones para nuestro campus de verano. Plazas limitadas.',
      contenido: 'Abrimos las inscripciones para el Campus de Verano 2025 que se llevará a cabo del 1 al 15 de julio. Este año contaremos con entrenadores profesionales y actividades especiales. El campus está dirigido a niños y jóvenes de 8 a 16 años. No esperes más y reserva tu plaza, ¡son limitadas!',
      fecha: '10 abril 2025',
      imagen: '/images/noticia2.jpg',
      formulario: true,
      tipoFormulario: 'inscripcion'
    }
  ];

  // Devolvemos un objeto para cada noticia
  return noticias.map((noticia) => {
    return {
      params: { id: noticia.id },
      props: { noticia },
    };
  });
}

// Recibimos la noticia como prop
const { noticia } = Astro.props;

// Configuración de la página
const title = noticia ? noticia.titulo : 'Noticia no encontrada';
const description = noticia ? noticia.descripcion : 'La noticia que buscas no existe';
---

<Layout title={title} description={description}>
  <main class="px-4 py-24">
    <SectionContainer>
      <a href="/news" class="inline-flex items-center text-green-400 hover:text-green-300 mb-6">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
        </svg>
        Volver a noticias
      </a>
      
      {noticia ? (
        <>
          <article class="bg-green-950 border border-green-800 rounded-xl overflow-hidden shadow-lg">
            <img src={noticia.imagen} alt={noticia.titulo} class="w-full h-96 object-cover" />
            <div class="p-8 space-y-4">
              <h1 class="text-3xl md:text-4xl font-bold text-white">{noticia.titulo}</h1>
              <p class="text-green-300">{noticia.fecha}</p>
              <div class="text-gray-200 space-y-4 mt-6">
                <p>{noticia.contenido}</p>
              </div>
            </div>
          </article>

          {noticia.formulario && (
            <div class="mt-12">
              <h2 class="text-2xl font-bold text-white mb-4">
                {noticia.tipoFormulario === 'inscripcion' 
                  ? 'Formulario de inscripción' 
                  : 'Contacto'}
              </h2>
              <NewsForm 
                tipo={noticia.tipoFormulario} 
                asunto={`Formulario: ${noticia.titulo}`}
              />
            </div>
          )}
        </>
      ) : (
        <div class="bg-red-900 border border-red-700 rounded-xl p-6 text-center">
          <h1 class="text-3xl font-bold text-white">Noticia no encontrada</h1>
          <p class="text-red-200 mt-2">La noticia que estás buscando no existe o ha sido eliminada.</p>
        </div>
      )}
    </SectionContainer>
  </main>
</Layout>